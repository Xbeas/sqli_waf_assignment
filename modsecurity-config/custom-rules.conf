# Custom SQL Injection Protection Rules
SecRule ARGS "@detectSQLi" \
    "id:1001,\
    phase:2,\
    block,\
    msg:'SQL Injection Attack Detected',\
    logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-sqli',\
    severity:'CRITICAL',\
    setvar:'tx.anomaly_score=+%{tx.critical_anomaly_score}',\
    setvar:'tx.sql_injection_score=+1'"

# Block common SQL injection patterns
SecRule ARGS "@rx (?i:(union.*select|select.*union|select.*from|insert.*into|delete.*from|update.*set|drop.*table|create.*table|alter.*table|exec.*sp_|xp_cmdshell))" \
    "id:1002,\
    phase:2,\
    block,\
    msg:'SQL Injection Keywords Detected',\
    severity:'CRITICAL'"

# Block SQL injection operators
SecRule ARGS "@rx (?i:(\s|^|;)(and|or|not|null|is|like|in|exists|between|union|select|insert|update|delete|drop|create|alter|exec|declare|cast|convert)\s)" \
    "id:1003,\
    phase:2,\
    block,\
    msg:'SQL Injection Operators Detected',\
    severity:'HIGH'"

# Block SQL comment sequences
SecRule ARGS "@rx (?i:(--|#|/\*|\*/|'|;))" \
    "id:1004,\
    phase:2,\
    block,\
    msg:'SQL Comment Sequence Detected',\
    severity:'HIGH'"